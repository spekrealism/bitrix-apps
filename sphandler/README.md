# Обработчик названий для смарт-процессов

Этот скрипт (`SmartProcessHandler.php`) добавляет ID элемента смарт-процесса в конец его названия при создании или обновлении. Например, "Моя задача" станет "Моя задача (12345)".

## Настройка

1.  **Настройте ID смарт-процесса.**
    Откройте файл `SmartProcessHandler.php` и укажите ID вашего смарт-процесса в константе `ENTITY_TYPE_ID`.

    ```php
    private const ENTITY_TYPE_ID = 153; // <--- Замените 153 на ID вашего смарт-процесса
    ```

2.  **Подключите обработчик.**
    Добавьте следующий код в файл `/local/php_interface/init.php` (если его нет, создайте его).

    ```php
    <?php

    // Укажите корректный путь к файлу SmartProcessHandler.php
    // Например, если вы положили его в /local/php_interface/classes/
    require_once __DIR__ . '/classes/SmartProcessHandler.php';

    // Регистрируем обработчики
    \SmartProcessTitleHandler::registerHandlers();

    ```

    Убедитесь, что путь в `require_once` верный относительно вашего файла `init.php`.

## Как это работает

Скрипт использует обработчики событий `onCrmDynamicItemAdd` и `onCrmDynamicItemUpdate`. При срабатывании этих событий для указанного смарт-процесса, он проверяет, есть ли в конце названия ID элемента в скобках. Если нет - он его добавляет.

Для отладки используется `\Bitrix\Main\Diag\Debug::writeToFile()`, который пишет лог в файл `__log.txt` в корне сайта.